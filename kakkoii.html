<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EN-DOC.</title>
    <link rel="stylesheet" href="kakkoii.css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=DotGothic16&family=Silkscreen&family=Sunflower:wght@300&display=swap" rel="stylesheet">
</head>

<body>
    <header>
      <h1><a href="index.html">EN-DOC.</a></h1>
      <!-- æ¼¢å ¡é¸å–®æŒ‰éˆ• -->
      <div class="menu-toggle">&#9776;</div>
      <div class="nav-links">
           <ul>
             <li><a href="schedule.html">schedule</a></li>
             <li><a href="photograph.html">photograph</a></li>
             <li><a href="kakkoii.html">kakkoii</a></li>
           </ul>
      </div>
    </header>
    
    


<!-- RPG Map -->
  <div class="map-container">
    <!-- æ‰€æœ‰è§’è‰²å®¹å™¨æœƒç”± JS å‹•æ…‹ç”¢ç”Ÿ -->
<div class="tile position-start" data-step="0">Start</div>
    <div class="tile position-spot" data-step="1"><a href="spot.html">Spot Journey</a></div>
    <div class="tile position-style" data-step="2"><a href="style.html">ENâ€˜s pick</a></div>
    <div class="tile position-murmur" data-step="3"><a href="murmur.html">MURMUR</a></div>
    <div class="tile position-stage" data-step="4"><a href="stage.html">stage</a></div>
    <!-- æ“ä½œè§’è‰² walkerï¼ˆåˆå§‹éš±è—ï¼‰ -->
    <div id="walker" class="position-walker" style="display: none;">
      <img class="chibi" alt="" />
      <div class="speech-bubble"></div>
    </div>
  </div>

<div id="character-select" class="character-select-overlay">
  <div class="character-select-box">
    <h2>choose your character</h2>
    <div class="character-options">
      <img src="images/heeseung.PNG" alt="HEESEUNG" data-name="HEESEUNG">
      <img src="images/jungwon.PNG" alt="JUNGWON" data-name="JUNGWON">
      <img src="images/jay.PNG" alt="JAY" data-name="JAY">
      <img src="images/jake.PNG" alt="JAKE" data-name="JAKE">
      <img src="images/sunghoon.PNG" alt="SUNGHOON" data-name="SUNGHOON">
      <img src="images/sunoo.PNG" alt="SUNOO" data-name="SUNOO">
      <img src="images/niki.png" alt="NIKI" data-name="NIKI">
    </div>
  </div>
</div>


  <!-- èƒŒæ™¯éŸ³æ¨‚ -->
  <audio id="bg-music" autoplay loop>
    <source src="music/bgm.mp3" type="audio/mpeg">
  </audio>
  <button id="music-toggle">ğŸ”Š</button>




    <footer>
        <p>Copyright Â© 2025 rumi_zzu ALL RIGHTS RESERVED.</p>
    </footer>


    <!-- åŠ å…¥ Bootstrap 4 CSS & JS -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/js/bootstrap.bundle.min.js"></script>
   
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const menuToggle = document.querySelector(".menu-toggle");
        const navLinks = document.querySelector(".nav-links");

        // åˆ‡æ›é¸å–®é–‹é—œ
        menuToggle.addEventListener("click", function (e) {
          e.stopPropagation(); // ä¸è®“å®ƒå†’æ³¡å‡ºå»
          navLinks.classList.toggle("active");
        });

        // é»é¸é¸å–®å…§éƒ¨ä¸é—œé–‰ï¼ˆä¾‹å¦‚é»é¸é€£çµï¼‰
        navLinks.addEventListener("click", function (e) {
          e.stopPropagation();
        });

        // é»é¸ç•«é¢å…¶ä»–åœ°æ–¹æœƒé—œé–‰é¸å–®
        document.addEventListener("click", function () {
          navLinks.classList.remove("active");
        });
      });
    </script>

   <script>
document.addEventListener("DOMContentLoaded", () => {
  // èƒŒæ™¯éŸ³æ¨‚é‚è¼¯
  const music = document.getElementById("bg-music");
  const musicToggle = document.getElementById("music-toggle");

  music.volume = 1;
  music.muted = false;

  document.addEventListener("click", () => {
    if (music.paused) music.play();
  }, { once: true });

  musicToggle.addEventListener("click", () => {
    if (music.muted) {
      music.muted = false;
      musicToggle.textContent = "ğŸ”Š";
    } else {
      music.muted = true;
      musicToggle.textContent = "ğŸ”‡";
    }
  });

  // éŠæˆ²è§’è‰²è¨­å®š
  const characterSelect = document.getElementById("character-select");
  const characterOptions = document.querySelectorAll(".character-options img");
  const mapContainer = document.querySelector(".map-container");
  const walker = document.getElementById("walker");
  const walkerImg = walker.querySelector("img");
  const speech = walker.querySelector(".speech-bubble");

  let selectedCharacter = null;
  let positions = [];
  let currentStep = 0;
  let walkInterval = null;
  let isWalking = false;

  const members = [
    { name: "HEESEUNG", src: "images/heeseung.PNG", position: "position-heeseung" },
    { name: "JUNGWON",  src: "images/jungwon.PNG",  position: "position-jungwon"  },
    { name: "JAY",      src: "images/jay.PNG",      position: "position-jay"      },
    { name: "JAKE",     src: "images/jake.PNG",     position: "position-jake"     },
    { name: "SUNGHOON", src: "images/sunghoon.PNG", position: "position-sunghoon" },
    { name: "SUNOO",    src: "images/sunoo.PNG",    position: "position-sunoo"    },
    { name: "NIKI",     src: "images/niki.png",     position: "position-niki"     }
  ];

  const phrases = {
  HEESEUNG: ["æ‹‰éºµæ‹‰éºµï½ğŸ¹", "Let's get itï¼", "ENGENEåƒé£½äº†å—ï¼Ÿ"],
  JUNGWON: ["yoi~~", "æœ€å–œæ­¡è·ŸENGENEä¸€èµ·ç©äº†ï¼", "æ˜å¤©è¦‹ğŸ¥°"],
  JAY: ["ì•¼ï¼", "è¦ä¸€èµ·å½ˆå‰ä»–å—ï½ğŸ¸", "æœƒç‚ºäº†ENGENEæ›´åŠªåŠ›çš„ï¼"],
  JAKE: ["ENGENEï½", "LOVE YOU GUYS~â¤ï¸"],
  SUNGHOON: ["HOLLO~", "æˆ‘çš„åŸºå› æ‡‰è©²ä¸éŒ¯å§ï¼Ÿ", "ENGENEæœ€æ£’ğŸ˜"],
  SUNOO: ["í—‰ğŸ˜³", "æˆ‘æƒ³åƒå†°æ·‡æ·‹ï¼", "ä¸€ç›´éƒ½å¾ˆè¬è¬ENGENEğŸ¤"],
  NIKI: ["Let's goï½", "åœ¨ENGENEèº«é‚Šå·²ç¶“å¾ˆå¹¸ç¦äº†ğŸ«¶", "ğŸ« "]
};

// ğŸŸ¨ é»å°è©±æ³¡æ³¡ => é¡¯ç¤ºéš¨æ©Ÿå°è©±
document.addEventListener("click", (e) => {
  const bubble = e.target.closest(".speech-bubble");
  if (!bubble) return;

  const wrapper = bubble.closest(".chibi-wrapper") || document.getElementById("walker");
  const img = wrapper.querySelector("img");

  // å¾åœ–ç‰‡æª”æ¡ˆæ¨æ¸¬è§’è‰²åç¨±ï¼ˆä½ å·²å›ºå®šç‚º images/xxx.PNGï¼‰
  let charName = img.getAttribute("alt") || img.getAttribute("src").split("/").pop().split(".")[0].toUpperCase();

  const lines = phrases[charName] || ["å—¨ï½"];
  const random = Math.floor(Math.random() * lines.length);
  bubble.textContent = lines[random];
});


  // é»è§’è‰²é¸æ“‡
  characterOptions.forEach(img => {
    img.addEventListener("click", () => {
      const selectedName = img.dataset.name;
      selectedCharacter = selectedName;

      const selectedMember = members.find(m => m.name === selectedName);
      walkerImg.src = selectedMember.src;
      walkerImg.alt = selectedMember.name;
      speech.textContent = `HIï¼æˆ‘æ˜¯ ${selectedMember.name}`;
      walker.style.display = "block";

      const startTile = document.querySelector(".position-start");
      walker.style.left = `${startTile.offsetLeft + startTile.offsetWidth / 2 - 32}px`;
      walker.style.top = `${startTile.offsetTop + startTile.offsetHeight / 2 - 32}px`;

      characterSelect.style.display = "none";

      // ç”¢ç”Ÿå…¶ä»–è§’è‰²
      members.filter(m => m.name !== selectedName).forEach(member => {
        const wrapper = document.createElement("div");
        wrapper.className = `chibi-wrapper ${member.position}`;
        wrapper.innerHTML = `
          <img src="${member.src}" class="chibi" alt="${member.name}" />
          <div class="speech-bubble">HIï¼æˆ‘æ˜¯ ${member.name}</div>
        `;
        mapContainer.appendChild(wrapper);
      });

      if (typeof window.onload === "function") window.onload();
    });
  });

  // èªªè©±æ³¡æ³¡
 speech.addEventListener("click", () => {
  if (!selectedCharacter) return;
  const lines = phrases[selectedCharacter] || ["å—¨ï½"];
  const random = Math.floor(Math.random() * lines.length);
  speech.textContent = lines[random];
});


  // è…³å°åŠŸèƒ½
  const MAX_FOOTPRINTS = 5;
  const MIN_DISTANCE = 10;
  let footprintList = [];
  let lastFootprint = { x: null, y: null };

  function addFootprint(x, y) {
    if (lastFootprint.x !== null) {
      const dx = x - lastFootprint.x;
      const dy = y - lastFootprint.y;
      const distance = Math.sqrt(dx * dx + dy * dy);
      if (distance < MIN_DISTANCE) return;
    }

    const fp = document.createElement("div");
    fp.className = "footprint";
    fp.style.left = `${x}px`;
    fp.style.top = `${y}px`;
    mapContainer.appendChild(fp);


    footprintList.push(fp);
    lastFootprint = { x, y };

    if (footprintList.length > MAX_FOOTPRINTS) {
      const old = footprintList.shift();
      old.remove();
    }

    setTimeout(() => {
      if (fp.parentElement) fp.remove();
    }, 2000);
  }

  // æ­¥è¡Œé‚è¼¯
  window.onload = () => {
    const tiles = document.querySelectorAll(".tile");
    positions = Array.from(tiles).map(tile => ({
      left: tile.offsetLeft + tile.offsetWidth / 2 - 32,
      top: tile.offsetTop + tile.offsetHeight / 2 - 32
    }));

    walker.style.left = `${positions[0].left}px`;
    walker.style.top = `${positions[0].top}px`;

    // é»tileé‚Šé‚Šæœƒèµ°éå»ä½†ä¸è·³è½‰é é¢
     tiles.forEach(tile => {
  tile.addEventListener("click", e => {
    const step = parseInt(tile.dataset.step);
    const link = tile.querySelector("a");

    if (step !== currentStep) {
      walkTo(step, () => {
        // åªæœ‰é»åˆ° <a> æ‰è·³è½‰
        if (link && e.target === link) {
          e.preventDefault(); // åœ¨é€™è£¡æ‰é˜»æ­¢é è¨­è¡Œç‚º
          window.location.href = link.href;
        }
      });
    } else {
      if (link && e.target === link) {
        e.preventDefault();
        window.location.href = link.href;
      }
    }
  });
});
  }



  function walkTo(step, callback) {
    if (isWalking) return;
    isWalking = true;
    if (walkInterval) clearInterval(walkInterval);

    const target = positions[step];
    const speed = 6;

    walkInterval = setInterval(() => {
      let currentX = parseFloat(walker.style.left || "0");
      let currentY = parseFloat(walker.style.top || "0");
      const dx = target.left - currentX;
      const dy = target.top - currentY;
      const distance = Math.sqrt(dx * dx + dy * dy);

      if (distance < speed) {
        walker.style.left = `${target.left}px`;
        walker.style.top = `${target.top}px`;
        currentStep = step;
        addFootprint(target.left + 20, target.top + 40);
        clearInterval(walkInterval);
        walkInterval = null;
        isWalking = false;
        if (typeof callback === "function") {
          setTimeout(callback, 200);
        }
        return;
      }

      const angle = Math.atan2(dy, dx);
      const vx = Math.cos(angle) * speed;
      const vy = Math.sin(angle) * speed;
      currentX += vx;
      currentY += vy;

      walker.style.left = `${currentX}px`;
      walker.style.top = `${currentY}px`;
      addFootprint(currentX + 20, currentY + 40);
    }, 30);
  }
});
</script>

<script data-goatcounter="https://rumizzu.goatcounter.com/count"
        async src="//gc.zgo.at/count.js"></script>


<style>
.footprint {
  position: absolute;
  width: 10px;
  height: 10px;
  background-color: rgba(0, 0, 0, 0.2);
  border-radius: 50%;
  pointer-events: none;
  z-index: 1;
}
</style>



</body>
</html>